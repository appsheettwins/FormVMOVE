<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</title>

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body{
  margin:0;
  font-family: "Prompt", sans-serif;
  background: linear-gradient(135deg,#43cea2,#185a9d);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.card{
  background:#fff;
  width:100%;
  max-width:420px;
  border-radius:20px;
  padding:22px;
  box-shadow:0 12px 30px rgba(0,0,0,.15);
}

h2{
  text-align:center;
  margin-bottom:10px;
  color:#185a9d;
}

.profile{
  text-align:center;
  font-size:15px;
  color:#555;
  margin-bottom:15px;
}

label{
  font-weight:600;
  margin-top:12px;
  display:block;
  color:#333;
}

input, select{
  width:100%;
  padding:13px;
  border-radius:12px;
  border:1px solid #ddd;
  margin-top:6px;
  font-size:16px;
}

input:focus, select:focus{
  outline:none;
  border-color:#43cea2;
}

button{
  width:100%;
  margin-top:20px;
  padding:14px;
  border:none;
  border-radius:14px;
  font-size:17px;
  font-weight:600;
  background:linear-gradient(135deg,#43cea2,#185a9d);
  color:#fff;
}

button:disabled{
  opacity:.6;
}

#loading{
  text-align:center;
  margin-top:10px;
  color:#185a9d;
}

#summary{
  display:none;
  text-align:center;
}

.success{
  font-size:18px;
  color:#185a9d;
  margin-bottom:10px;
}
</style>
</head>

<body>

<div class="card" id="formBox">
  <h2>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>

  <div class="profile">
    LINE: <strong id="displayName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</strong>
  </div>

  <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
  <input id="fullname" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">

  <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
  <input id="phone" type="tel" inputmode="numeric" maxlength="10" placeholder="0XXXXXXXXX">

  <!-- ‚úÖ ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô v1.4 -->
  <label>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
  <select id="activity" onchange="updateItems()">
  <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° --</option>
  </select>

  <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</label>
  <select id="item">
  <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ --</option>
  </select>


  <button id="saveBtn" onclick="submitForm()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  <div id="loading" style="display:none;">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...</div>
</div>

<div class="card" id="summary">
  <div class="success">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</div>
  <p id="sumText"></p>
  <button onclick="resetForm()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà</button>
</div>

<script>
const LIFF_ID = "2008940385-hkDtMTsg";
const GAS_URL = "https://script.google.com/macros/s/AKfycbzHGWEA9JYbd1e9-cGnod10qrWuy-hz39IEDd1DhjkCa8bRP-D4qVLkGXNQbV2dcjNI/exec";

let lineProfile = {};
let activityMap = {}; // üëà ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô object

async function init() {
  await liff.init({ liffId: LIFF_ID });

  if (!liff.isLoggedIn()) {
    liff.login();
    return;
  }

  const profile = await liff.getProfile();
  lineProfile = profile;
  document.getElementById("displayName").innerText = profile.displayName;

  loadActivity();
}

/* ===== LOAD ACTIVITY ===== */
function loadActivity() {
  fetch(GAS_URL + "?mode=activity")
    .then(res => res.json())
    .then(data => {
      activityMap = data;

      const act = document.getElementById("activity");
      act.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° --</option>';

      // üëá ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏≠‡∏µ‡∏Å‡πÅ‡∏•‡πâ‡∏ß
      Object.keys(activityMap).forEach(activityName => {
        act.innerHTML +=
          `<option value="${activityName}">${activityName}</option>`;
      });
    });
}

/* ===== UPDATE ITEM (v1.4 STYLE) ===== */
function updateItems() {
  const activity = document.getElementById("activity").value;
  const item = document.getElementById("item");

  item.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ --</option>';

  if (activityMap[activity]) {
    activityMap[activity].forEach(i => {
      item.innerHTML += `<option value="${i}">${i}</option>`;
    });
  }
}

init();
</script>

</body>
</html>
